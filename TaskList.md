# Задачи

## READ.ME

* [ ] Перевести Read.Me на английский язык
* [ ] в Read.Me оставить только рекламу продукта, остальное вынести в вики


## Файлы исходного кода

* [x] файлы хранить в кодировке ANSI
* [ ] Использовать оператор переноса для строк кода больше 80 символов


## Юникод

* [x] к строкам применять макрос `__TEXT` или WStr()
* [x] юникодные функции и структуры должны быть с W на конце, неюникодные — с A.
* [x] все интерфейсы работают только с юникодными строками

## Сборка

* [x] Пакетный файл, в котором прописаны пути к цепочке инструментов компиляции
* [x] Makefile для сборки
* [x] файл с зависимостями
* [x] сборка под GCC разных версий
* [ ] сборка под LLVM
* [ ] сборка под GAS и GAS64
* [ ] предварительно скомпилированные заголовочники


## Создание и уничтожение объектов

[x] Объекты создаёт функция CreateInstance
[x] Уничтожение объектов в обратном порядке: сначала освобождают ссылки на внешние объекты, затем на внутренние
[x] Слабые ссылки для глобальных объектов


## Асинхронность

Использовать асинхронные функции:

* [ ] AcceptEx (ConnectEx)
* [x] WSARecv
* [x] WSASend (TransmitPackets)
* [ ] DisconnectEx


## Строки

* [x] тип данных строк, существующих в частной куче
* [x] интерфейсы существующие в куче возвращают строки из кучи


## Методы

Обработчики запросов — в свои отдельные классы:

* [ ] CONNECT
* [ ] COPY
* [x] GET
* [x] HEAD
* [ ] DELETE
* [ ] LOCK
* [ ] MKCOL
* [ ] MOVE
* [ ] OPTIONS
* [ ] POST
* [ ] PATCH
* [ ] PROPFIND
* [ ] PROPPATCH
* [ ] PUT
* [ ] TRACE
* [ ] UNLOCK


## Сделать

Эти задачи выполнить в любом порядке.

* [ ] Проверить на переполнение буферов от функции WideCharToMultiByte
* [ ] Проверить на переполнение буферов от функции lstrcpy

* [ ] Реэнтерабельные функции‐члены объектов из разных потоков.
* [ ] Указатели: NULL для типов винапи, 0 для встроенных типов.
* [ ] Документировать все успешные возвращаемые значения для функций и интерфейсов.
* [ ] Найти все магические числа и заменить на именованные константы.
* [ ] Улучшение производительности: хранение заголовков запроса и ответа в виде двоичного дерева.
* [ ] Кеширование файлов.
* [ ] Согласование содержимого по заголовкам Accept, Accept-Charset, Accept-Encoding, Accept-Language, User-Agent.
* [ ] Разные реализации интерфейса IServerResponse для разных версий http‐протокола.
* [ ] Различать версию HTTP/1.0 и HTTP/1.1, отдавать соответствующие заголовки.
* [ ] Хранить нераспознанные заголовки запроса.
* [ ] Журналирование запросов.
* [ ] Добавить возможность парольных ресурсов.
* [x] Все коды ошибок WinAPI с описанием отправлять клиенту.
* [x] Новый объект Uri, учитывающий Scheme, Authority, Path, Query, Fragment.
* [ ] Проверить функцию раскодировки URL, возможно, есть библиотечная.
* [x] Убрать функцию загрузки виртуальной таблицы, загружать виртуальную таблицу статически.
* [x] Новый интерфейс объекта сервера: функции приостановки, возобновления работы. Функция Run не должжна блокировать поток.
* [ ] Передача на сервер через PUT очень больших файлов.
* [x] Исправить предупреждения о присвоении указателей разных типов на реальные функции виртуальных таблиц интерфейсов.
* [ ] Поддержка в запросе множественных байтовых диапазонов.
* [ ] Асинхронный трубопровод в CGI.


## Контроль жизни объектов

* [x] Возвращать слабые ссылки на коллекцию сайтов
* [x] Возвращать слабые ссылки на коллекцию обработчиков запроса
* [ ] Атомарный и неатомарный счётчики ссылок где это нужно.
* [ ] Умные указатели для объектов ядра системы.
* [ ] Умные указатели для интерфейсов.


## Выполнено

* [x] Исправить перемотку видеофайлов.
